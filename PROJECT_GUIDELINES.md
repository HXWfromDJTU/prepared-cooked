⚠️ **重要提醒** ⚠️
# 本文档是《预制菜厨房》项目的核心开发指导原则
**每次开始开发工作前都必须仔细阅读并严格遵守。任何偏离此文档的开发行为都是不被允许的。**

---

# 《预制菜厨房》项目开发指导原则

## 🎯 项目核心理念

### 分步交付验证原则
- **阶段性交付**: 每个阶段都必须产出完整可运行的版本
- **严格验收**: 只有验收通过后才能够进入下一阶段
- **质量优先**: 先功能后优化，先可用后完美
- **渐进迭代**: 避免跳跃式开发和功能蔓延

### 验证体系
- **人工验证**: 必须通过明确的人工测试清单
- **自动化验证**: 关键功能需要单元测试和集成测试
- **性能验证**: 每阶段都要确保性能基准达标
- **兼容性验证**: 确保多浏览器环境正常运行

---

## 📦 六阶段开发计划

### 🔥 第一阶段：最小可运行原型 (MVP-1)
**目标**: 建立最基础的可交互原型，验证核心技术栈可行性

#### 📋 具体交付物:
1. **基础项目框架**
   - TypeScript + Phaser 3 项目可启动
   - 开发服务器正常运行 (localhost:3000)
   - 基础的webpack/vite构建配置

2. **最简场景和角色**
   - 一个厨房场景（纯色背景 + 简单几何图形代表设备）
   - 一个可控制的厨师角色（简单方形占位符）
   - WASD键控制移动功能

#### ✅ 验收标准（必须100%通过）:
- [ ] 项目能在浏览器中正常启动
- [ ] 厨师角色能响应WASD键移动
- [ ] 控制台无关键错误信息
- [ ] 移动边界正确限制（不能移出屏幕）
- [ ] 帧率稳定保持在30fps以上

#### 🔍 验证方法:
**人工验证清单:**
1. ✅ 在Chrome浏览器中打开 localhost:3000
2. ✅ 在Firefox浏览器中打开 localhost:3000
3. ✅ 按W键，角色向上移动
4. ✅ 按S键，角色向下移动
5. ✅ 按A键，角色向左移动
6. ✅ 按D键，角色向右移动
7. ✅ 角色不能移动到屏幕边界之外
8. ✅ 按F12打开控制台，确认无红色错误信息

**自动化验证:**
```javascript
describe('MVP-1 Basic Movement', () => {
  test('Player responds to WASD input', () => {
    // 模拟按键输入测试
  });
  test('Player stays within screen bounds', () => {
    // 边界检测测试
  });
});
```

**⛔ 验收完成标志**: 能够在浏览器中控制角色移动的可运行版本，所有验收标准通过

---

### 🔥 第二阶段：单一物品交互循环 (MVP-2)
**目标**: 实现最简单的"拿取→操作→放置"循环

#### 📋 具体交付物:
1. **物品交互系统**
   - 一种预制菜（简单占位符图形，如蓝色方块表示冷冻状态）
   - 一个微波炉（带进度条的交互区域）
   - 一个装盘台（绿色圆形区域）
   - 一个出餐口（黄色矩形区域）

2. **基础交互逻辑**
   - E键拿取/放置物品
   - 预制菜状态：冷冻（蓝色）→解冻中（黄色）→已解冻（红色）
   - 微波炉解冻进度显示（5秒倒计时）

#### ✅ 验收标准（必须100%通过）:
- [ ] 能用E键拿取冷冻预制菜
- [ ] 拿着预制菜时角色头顶显示物品图标
- [ ] 能将预制菜放入微波炉并自动启动解冻
- [ ] 解冻进度条正确显示5秒倒计时
- [ ] 解冻完成后预制菜变色（蓝色→红色）
- [ ] 解冻完成后能用E键取出
- [ ] 拿着解冻食材能在装盘台装盘（生成新的装盘物品）
- [ ] 拿着装盘食材能送到出餐口并消失

#### 🔍 验证方法:
**人工验证清单:**
1. ✅ 走到预制菜前按E键，确认能拿起（角色头顶出现图标）
2. ✅ 拿着预制菜走到微波炉前按E键，确认能放入
3. ✅ 微波炉进度条显示并从5秒开始倒计时
4. ✅ 倒计时过程中预制菜颜色变为黄色
5. ✅ 倒计时结束后预制菜变为红色
6. ✅ 倒计时结束后按E键能取出
7. ✅ 拿着红色解冻食材走到装盘台按E键能装盘
8. ✅ 装盘后生成新的装盘物品
9. ✅ 拿着装盘食材走到出餐口按E键物品消失

**自动化验证脚本:**
```javascript
describe('MVP-2 Food Processing Cycle', () => {
  test('Complete defrost-plate-serve cycle', () => {
    // 自动化模拟整个流程测试
  });
  test('Food state changes correctly', () => {
    // 食材状态变化测试
  });
});
```

**⛔ 验收完成标志**: 能完成一次完整的食材处理循环，所有验收标准通过

---

### 🔥 第三阶段：订单和计分系统 (MVP-3)
**目标**: 加入游戏目标和反馈机制

#### 📋 具体交付物:
1. **订单系统**
   - 屏幕右上角显示一个简单订单UI（如：黄米凉糕 x1）
   - 订单完成检测逻辑
   - 基础计分逻辑（每完成一单+100分）

2. **时间和得分UI**
   - 屏幕左上角显示3分钟倒计时
   - 屏幕左上角显示当前分数
   - 订单完成时显示"+100分"浮动文字
   - 游戏结束界面显示最终分数

#### ✅ 验收标准（必须100%通过）:
- [ ] 游戏开始时右上角显示一个订单
- [ ] 完成订单后分数增加100分
- [ ] 完成订单后显示"+100分"浮动提示
- [ ] 完成一个订单后自动生成下一个订单
- [ ] 3分钟倒计时正确显示（180秒→0秒）
- [ ] 3分钟后游戏自动结束
- [ ] 游戏结束后显示最终分数界面
- [ ] 结束界面有"重新开始"按钮

#### 🔍 验证方法:
**人工验证:**
1. ✅ 游戏开始时确认右上角订单显示
2. ✅ 完成一个订单，确认分数从0变为100
3. ✅ 确认出现"+100分"浮动文字
4. ✅ 确认新订单自动出现
5. ✅ 记录开始时间，等待3分钟确认游戏结束
6. ✅ 确认结束界面显示最终得分
7. ✅ 点击"重新开始"确认能重新开始游戏

**⛔ 验收完成标志**: 具有完整游戏循环的可玩版本，所有验收标准通过

---

### 🔥 第四阶段：洗碗和资源管理 (MVP-4)
**目标**: 增加资源限制，提升游戏策略性

#### 📋 具体交付物:
1. **盘子管理系统**
   - 游戏开始时提供3个干净盘子
   - 装盘后盘子变为脏盘子出现在出餐口
   - 洗碗池区域（紫色矩形）
   - 洗碗流程（3秒进度条）

2. **资源压力机制**
   - 没有干净盘子时无法装盘
   - 必须洗碗才能获得新的干净盘子

#### ✅ 验收标准（必须100%通过）:
- [ ] 游戏开始时显示"干净盘子: 3"
- [ ] 装盘时干净盘子数量减1
- [ ] 送餐后在出餐口出现脏盘子
- [ ] 干净盘子为0时无法在装盘台装盘
- [ ] 能拿起脏盘子并放入洗碗池
- [ ] 洗碗池显示3秒进度条
- [ ] 洗碗完成后干净盘子数量+1
- [ ] 脏盘子变为干净盘子可重新使用

#### 🔍 验证方法:
**人工验证:**
1. ✅ 确认开始时有3个干净盘子
2. ✅ 完成3次装盘后干净盘子变为0
3. ✅ 干净盘子为0时尝试装盘，确认无法装盘
4. ✅ 拿起脏盘子放入洗碗池
5. ✅ 等待3秒洗碗完成
6. ✅ 确认干净盘子数量恢复为1
7. ✅ 确认能继续使用新的干净盘子装盘

**⛔ 验收完成标志**: 需要管理盘子资源的完整游戏体验，所有验收标准通过

---

### 🔥 第五阶段：多菜品和难度选择 (MVP-5)
**目标**: 丰富游戏内容，增加重玩价值

#### 📋 具体交付物:
1. **菜品数据系统**
   - 3种不同复杂度的菜品：
     - 简单：黄米凉糕（1种预制菜）
     - 中等：番茄牛腩饭（2种预制菜）  
     - 困难：牛大骨套餐（3种预制菜）

2. **难度选择系统**
   - 主菜单增加简单/中等/困难三个难度选择
   - 不同难度订单生成频率不同
   - 不同难度客人等待时间不同

#### ✅ 验收标准（必须100%通过）:
- [ ] 主菜单显示三个难度选择按钮
- [ ] 简单难度每30秒生成一个简单订单
- [ ] 中等难度每20秒生成中等订单
- [ ] 困难难度每15秒生成困难订单
- [ ] 复杂订单需要多种预制菜组合
- [ ] 不同难度分数倍率不同（简单x1，中等x2，困难x3）

**⛔ 验收完成标志**: 有多种玩法选择的完整游戏，所有验收标准通过

---

### 🔥 第六阶段：贾老板系统和完整体验 (正式版)
**目标**: 完成所有特色功能

#### 📋 具体交付物:
1. **贾老板催促系统**
   - 贾老板角色显示在屏幕一侧
   - 基于订单等待时间的催促机制
   - 催促台词和表情变化

2. **完整用户体验**
   - 本地排行榜系统
   - 基础音效系统
   - 完整的美术素材替换

**⛔ 验收完成标志**: 功能完整的正式发布版本

---

## 🔄 阶段间验证流程（强制执行）

### 每阶段完成后必须进行的验证:
1. **功能验证** - 所有验收标准必须100%通过
2. **性能验证** - 确保帧率稳定（>30fps）
3. **兼容性验证** - 至少在Chrome和Firefox测试通过
4. **用户体验验证** - 找1-2个人试玩并收集反馈
5. **代码质量验证** - 无console.error，关键功能有注释

### ⛔ 验证不通过时的处理流程:
1. **立即停止下一阶段开发**
2. **记录所有未通过的验收标准**
3. **逐一修复问题**
4. **重新进行完整验证**
5. **所有问题解决后才能继续下一阶段**

### 🚨 严格禁止的行为:
- ❌ 跳过任何验收标准
- ❌ 部分通过就进入下一阶段
- ❌ 同时开发多个阶段的功能
- ❌ 在当前阶段未完成时添加下个阶段的功能
- ❌ 忽略性能和兼容性问题

---

## 📊 质量控制Checklist

### 每阶段开发前:
- [ ] 仔细阅读本指导文档
- [ ] 明确当前阶段的所有交付物
- [ ] 理解所有验收标准
- [ ] 准备验证测试环境

### 每阶段开发中:
- [ ] 严格按照交付物清单开发
- [ ] 不添加计划外的功能
- [ ] 实时检查性能指标
- [ ] 及时处理console错误

### 每阶段开发后:
- [ ] 执行完整的人工验证
- [ ] 运行自动化测试（如有）
- [ ] 进行跨浏览器测试
- [ ] 记录发现的问题并修复
- [ ] 获得完整验收通过确认

---

## 🎯 项目成功标准

### 技术标准:
- 所有阶段验收标准100%通过
- 游戏在主流浏览器稳定运行
- 帧率始终保持在30fps以上
- 无严重bug和错误

### 体验标准:
- 游戏操作流畅直观
- 核心玩法循环完整有趣
- UI界面清晰易懂
- 具备基本的重玩价值

---

## 📝 开发日志要求

### 每日开发记录:
- 当天完成的具体功能
- 遇到的问题和解决方案
- 当前阶段的完成进度
- 下一步计划

### 阶段完成记录:
- 详细记录所有验收测试结果
- 问题修复过程
- 最终验收通过时间
- 经验教训总结

---

**最后提醒**: 这个文档是项目成功的基石，必须严格遵守每一条规则。质量和用户体验永远比开发速度更重要。